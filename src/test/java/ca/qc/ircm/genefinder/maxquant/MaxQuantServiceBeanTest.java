package ca.qc.ircm.genefinder.maxquant;

import static org.junit.Assert.assertEquals;
import static org.mockito.Matchers.any;
import static org.mockito.Mockito.atLeastOnce;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;
import java.util.Locale;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mock;

import ca.qc.ircm.genefinder.maxquant.MaxQuantServiceBean;
import ca.qc.ircm.genefinder.ncbi.NcbiService;
import ca.qc.ircm.genefinder.ncbi.ProteinMapping;
import ca.qc.ircm.genefinder.organism.Organism;
import ca.qc.ircm.genefinder.test.config.TestLoggingRunner;
import ca.qc.ircm.progress_bar.ProgressBar;

@RunWith(TestLoggingRunner.class)
public class MaxQuantServiceBeanTest {
    private MaxQuantServiceBean maxQuantServiceBean;
    @Mock
    private NcbiService ncbiService;
    @Mock
    private Organism organism;
    @Mock
    private ProgressBar progressBar;
    private Locale locale;
    private Integer organismId = 9606;

    @Before
    public void beforeTest() {
        maxQuantServiceBean = new MaxQuantServiceBean(ncbiService);
        locale = Locale.getDefault();
        when(organism.getId()).thenReturn(organismId);
        when(progressBar.step(any(Double.class))).thenReturn(progressBar);
    }

    @Test
    public void findGeneNames() throws Throwable {
        File file = new File(getClass().getResource("/proteinGroups.txt").toURI());
        List<ProteinMapping> mappings = new ArrayList<ProteinMapping>();
        mappings.add(getProteinMapping(4262120, "ABC"));
        mappings.add(getProteinMapping(58201131, "ABC"));
        mappings.add(getProteinMapping(270297794, "ABC"));
        mappings.add(getProteinMapping(13560677, "FFE"));
        mappings.add(getProteinMapping(13492060, "RTS"));
        mappings.add(getProteinMapping(63100331, "FAF"));
        mappings.add(getProteinMapping(30583211, "FAF"));
        mappings.add(getProteinMapping(17512236, "FAF"));
        when(ncbiService.allProteinMappings(any(Organism.class), any(ProgressBar.class), any(Locale.class)))
                .thenReturn(mappings);

        File temp = maxQuantServiceBean.findGeneNames(organism, file, progressBar, locale);

        verify(progressBar, atLeastOnce()).setProgress(any(Double.class));
        verify(progressBar, atLeastOnce()).setMessage(any(String.class));
        verify(ncbiService).allProteinMappings(organism, progressBar, locale);
        try (BufferedReader reader = new BufferedReader(new InputStreamReader(new FileInputStream(temp)))) {
            String line = reader.readLine();
            assertEquals(true, line.startsWith("Gene\t"));
            line = reader.readLine();
            assertEquals(
                    "\tCON__ENSEMBL:ENSBTAP00000038253\tCON__ENSEMBL:ENSBTAP00000038253\t9\t1\t1\t>ENSEMBL:ENSBTAP00000038253 (Bos taurus) 63 kDa protein\t1\t9\t1\t1\t9\t9\t1\t1\t1\t1\t13\t2\t2\t63.165\t606\t606\t1\t1\t7.894E-114\tBy matching\tBy MS/MS\t13\t13\t42128000\t20066000\t22062000\t1316500\t627070\t689440\t0\t40671000\t0\t1\t1\t\t\t+\t0\t621;1384;2160;4740;5619;6464;6750;6751;7431\tFalse;False;False;False;True;False;False;False;False\t632;1411;1412;2198;4809;4810;5717;6580;6870;6871;7558\t1349;1350;2965;2966;2967;2968;4594;4595;4596;10040;10041;10042;10043;11905;11906;13659;13660;13661;13662;14289;14290;14291;14292;14293;14294;15735;15736;15737\t2095;2096;2097;2098;2099;2100;4536;4537;4538;6837;6838;6839;6840;6841;6842;6843;6844;6845;6846;14687;14688;14689;14690;14691;14692;17212;19644;19645;19646;19647;19648;19649;20527;20528;20529;20530;20531;20532;20533;20534;20535;20536;20537;20538;20539;20540;20541;20542;20543;22648;22649;22650;22651;22652;22653;22654;22655;22656;22657\t2099;4537;6837;14689;17212;19644;20529;20538;22657\t0\t465",
                    line);
            line = reader.readLine();
            assertEquals(
                    "ABC;FFE;RTS\tgi|4262120;gi|58201131;gi|270297794;gi|321271362;gi|13560677;gi|13492060\tgi|4262120;gi|58201131;gi|270297794;gi|321271362;gi|13560677;gi|13492060;gi|1066762;gi|6425038;gi|6425037;gi|6425036;gi|6425035;gi|6425034;gi|6425033;gi|6425032;gi|6425031;gi|6425030;gi|6425029;gi|6425028;gi|6425027;gi|6425026;gi|6425025;gi|6425024;gi|183857;gi|163140875;gi|194719364;gi|4837723;gi|66731527;gi|183855;gi|183851;gi|75491671;gi|70959450;gi|62823011;gi|51594277;gi|47679341;gi|34224021;gi|319739575;gi|269931975;gi|23268683;gi|23268451;gi|218157726;gi|193244963;gi|193244959;gi|193244957;gi|193244955;gi|193244953;gi|193244951;gi|193244949;gi|193244947;gi|193244941;gi|193244939;gi|193244937;gi|193244935;gi|193244933;gi|193244931;gi|193244929;gi|193244927;gi|193244925;gi|193244923;gi|193244915;gi|193244913;gi|193244909;gi|193244907;gi|193244905;gi|193244903;gi|193244901;gi|193244899;gi|193244897;gi|193244895;gi|193244893;gi|193244891;gi|193244889;gi|193244887;gi|193244883;gi|193244881;gi|193244879;gi|193244875;gi|193244873;gi|193244869;gi|193244867;gi|184186852;gi|13273496;gi|109893891;gi|13432059;gi|12083483;gi|12083481;gi|40042510;gi|31731;gi|183872;gi|183832;gi|6003532;gi|4378748;gi|190613770;gi|223114;gi|21336474;gi|999567;gi|999565;gi|61679606;gi|61679604;CON__P02070;gi|999562;gi|999560;gi|999550;gi|999546;gi|999541;gi|999538;gi|93279215;gi|93279213;gi|93279211;gi|93279209;gi|9256892;gi|9256891;gi|9256889;gi|9256888;gi|9256886;gi|9256884;gi|90108560;gi|90108558;gi|90108556;gi|8569446;gi|8569444;gi|62738860;gi|61679774;gi|61679772;gi|61679770;gi|61679768;gi|61679766;gi|61679764;gi|61679719;gi|61679717;gi|61679715;gi|61679713;gi|61679711;gi|61679709;gi|61679707;gi|61679705;gi|61679702;gi|61679700;gi|61679698;gi|61679696;gi|61679693;gi|61679691;gi|61679687;gi|61679685;gi|61679683;gi|61679681;gi|61679659;gi|61679657;gi|61679655;gi|61679653;gi|61679651;gi|61679649;gi|61679647;gi|61679645;gi|61679643;gi|61679641;gi|61679639;gi|61679637;gi|61679602;gi|61679600;gi|61679598;gi|61679596;gi|61679480;gi|61679478;gi|60594387;gi|60594385;gi|60594372;gi|60594370;gi|60594368;gi|60594366;gi|60594363;gi|60594361;gi|60594356;gi|60594354;gi|60594332;gi|60594330;gi|60594328;gi|60594326;gi|5822284;gi|5822282;gi|58177615;gi|58177613;gi|576044;gi|576043;gi|576042;gi|576041;gi|576040;gi|576039;gi|576038;gi|576037;gi|56967334;gi|56967332;gi|56967330;gi|56967328;gi|56967326;gi|56967324;gi|56967322;gi|56967320;gi|56967318;gi|56967316;gi|56967309;gi|56967307;gi|568786555;gi|568786553;gi|56553729;gi|56553727;gi|56553725;gi|56553723;gi|554793824;gi|554793822;gi|554793820;gi|554793818;gi|5542480;gi|5542478;gi|5542476;gi|5542474;gi|550544900;gi|550544898;gi|550544896;gi|550544894;gi|550544892;gi|550544890;gi|550544888;gi|550544886;gi|544191719;gi|544191717;gi|520729552;gi|520729550;gi|514829626;gi|514829624;gi|508123667;gi|494106;gi|494104;gi|494102;gi|494100;gi|494098;gi|494096;gi|494077;gi|494075;gi|493853;gi|493851;gi|4929996;gi|4929995;gi|4929994;gi|4929993;gi|4699600;gi|4699598;gi|46014948;gi|46014946;gi|4558076;gi|4558074;gi|448262351;gi|448262349;gi|448262347;gi|442856;gi|442854;gi|442852;gi|442850;gi|442753;gi|442751;gi|442664;gi|442662;gi|40889698;gi|40889696;gi|40889694;gi|40889692;gi|40889688;gi|40889686;gi|40889142;gi|40889140;gi|3891443;gi|3891441;gi|3891439;gi|3891437;gi|3891370;gi|3891368;gi|37928146;gi|37928144;gi|37928141;gi|37928097;gi|37928095;gi|37928092;gi|37928090;gi|37926373;gi|37926371;gi|3660436;gi|3660434;gi|3660147;gi|3660145;gi|353529981;gi|34811115;gi|34811113;gi|34811111;gi|34811109;gi|34811107;gi|34811105;gi|34811103;gi|34811101;gi|34811099;gi|34811097;gi|34811095;gi|34811093;gi|34811091;gi|34811089;gi|34811087;gi|34811085;gi|34810694;gi|34810692;gi|34810690;gi|34810688;gi|34810630;gi|34810628;gi|346652039;gi|346652038;gi|345531709;gi|345531707;gi|345531705;gi|344422;gi|342351135;gi|342351133;gi|342351131;gi|335892370;gi|33357233;gi|33357231;gi|3318954;gi|3318953;gi|3318951;gi|3318949;gi|327533808;gi|327533806;gi|323463186;gi|323463184;gi|323463182;gi|323463180;gi|323463178;gi|323463176;gi|3212438;gi|3212316;gi|3212314;gi|3212312;gi|3212310;gi|313103898;gi|313103896;gi|3114513;gi|3114511;gi|3114509;gi|300508780;gi|300508778;gi|300508775;gi|299856684;gi|299856682;gi|2982015;gi|2982014;gi|2981685;gi|2981683;gi|2981665;gi|2981663;gi|294979723;gi|294979721;gi|27574253;gi|27574252;gi|27574250;gi|27574248;gi|27574246;gi|27574245;gi|27574243;gi|27574242;gi|27574240;gi|27574239;gi|27574237;gi|27574235;gi|27574233;gi|27574232;gi|27574230;gi|27065154;gi|2624530;gi|2624528;gi|2624526;gi|2624524;gi|255311759;gi|255311757;gi|254839698;gi|254839696;gi|254839694;gi|254839692;gi|24987590;gi|24987588;gi|24987585;gi|24987583;gi|24987581;gi|24987579;gi|24987577;gi|24987575;gi|24987573;gi|24159098;gi|24159096;gi|2392697;gi|2392695;gi|2392693;gi|2392691;gi|231025;gi|231023;gi|230874;gi|230556;gi|230554;gi|230546;gi|230356;gi|230354;gi|230193;gi|230191;gi|229986;gi|229969;gi|229965;gi|229963;gi|229961;gi|229959;gi|229754;gi|229752;gi|229597714;gi|229172;gi|229161;gi|228311821;gi|228311819;gi|228311814;gi|228311812;gi|22218694;gi|22218692;gi|209447416;gi|209447414;gi|209447412;gi|209447410;gi|209447408;gi|20664384;gi|20150593;gi|20150591;gi|20150589;gi|20150587;gi|20150585;gi|20150583;gi|20150359;gi|20150357;gi|20150354;gi|20150352;gi|20150350;gi|20150348;gi|1942688;gi|1942686;gi|1942684;gi|1942682;gi|189339653;gi|189339651;gi|187940241;gi|1827906;gi|1827904;gi|1827877;gi|1827875;gi|1827873;gi|1827871;gi|1827702;gi|1827700;gi|169791777;gi|169791775;gi|169791773;gi|169791771;gi|16975228;gi|161760890;gi|15988416;gi|15988415;gi|15988414;gi|15988413;gi|15988106;gi|15988104;gi|157884212;gi|1431652;gi|1431650;gi|1330312;gi|12084714;gi|12084712;gi|119389637;gi|119389635;gi|109157483;gi|109157481;gi|109157479;gi|109157477;gi|73762521;gi|71727271;gi|71727269;gi|71727267;gi|71727265;gi|71727263;gi|71727261;gi|71727259;gi|71727257;gi|71727255;gi|71727253;gi|71727251;gi|71727249;gi|71727247;gi|71727245;gi|71727243;gi|71727241;gi|71727239;gi|71727237;gi|71727235;gi|71727233;gi|71727231;gi|71727229;gi|71727227;gi|71727225;gi|71727223;gi|71727221;gi|71727219;gi|71727217;gi|71727215;gi|71727213;gi|71727211;gi|71727209;gi|71727207;gi|71727205;gi|71727203;gi|71727201;gi|71727199;gi|71727197;gi|71727195;gi|71727193;gi|71727191;gi|71727189;gi|71727187;gi|71727185;gi|71727183;gi|71727181;gi|71727179;gi|71727177;gi|71727175;gi|71727173;gi|71727171;gi|71727169;gi|71727167;gi|71727165;gi|71727163;gi|71727161;gi|6715607;gi|6003534;gi|56749861;gi|56749860;gi|56749856;gi|544336747;gi|532522;gi|532521;gi|532520;gi|532519;gi|532518;gi|532517;gi|532516;gi|532515;gi|532514;gi|532513;gi|532512;gi|532511;gi|532510;gi|532509;gi|532508;gi|532507;gi|532506;gi|51235684;gi|49456781;gi|49456779;gi|49168544;gi|4885393;gi|47124546;gi|46854768;gi|455997;gi|455996;gi|455995;gi|455994;gi|455993;gi|4504351;gi|4504349;gi|442848;gi|442846;gi|4378804;gi|40886941;gi|40046982;gi|334878433;gi|334878432;gi|318055241;gi|31733;gi|31729;gi|31128;gi|30511;gi|30349217;gi|302313145;gi|302313143;gi|302313141;gi|302313139;gi|302313137;gi|29446;gi|29441;gi|29437;gi|284521124;gi|284521122;gi|28302131;gi|269931981;gi|269931977;gi|26892090;gi|256028940;gi|237675828;gi|23268449;gi|2253432;gi|223971865;gi|223970113;gi|22094827;gi|20809485;gi|189053145;gi|18462107;gi|18462105;gi|18462103;gi|18462101;gi|18462099;gi|18462097;gi|18462095;gi|18462093;gi|18462091;gi|18462089;gi|18462087;gi|18462085;gi|18462083;gi|18462081;gi|18462079;gi|18462077;gi|18462075;gi|18418633;gi|183945;gi|183830;gi|182966;gi|182965;gi|182963;gi|182962;gi|18088861;gi|15930212;gi|158254416;gi|15012034;gi|15012032;gi|14595979;gi|13937929;gi|13549112;gi|133711987;gi|122726;gi|122713;gi|120660380;gi|120660064;gi|119589212;gi|119589211;gi|119589210;gi|119589208;gi|118199993;gi|118199991;gi|117607056;gi|11493500;gi|1066780;gi|1066777;gi|1066774;gi|1066771;gi|1066768;gi|1066765;gi|183885;gi|31725;gi|183817;CON__Q3SX09\t1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1\t1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1\t1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1\t>gi|4262120|gb|AAD14420.1|S82767_1 beta-globin, partial [Homo sapiens];>gi|58201131|gb|AAW66689.1| truncated beta-globin [Homo sapiens];>gi|270297794|gb|ACZ67952.1| beta globin [Homo sapiens];>gi|321271362|gb|ADW79453.1| hemoglobin beta chain [Homo sapiens\t668\t1\t1\t1\t1\t1\t1\t1\t1\t1\t58.8\t58.8\t58.8\t2.1044\t17\t17;40;41;57;59;59;60;61;61;61;61;61;61;61;61;61;61;61;61;61;61;61;61;63;88;89;101;101;101;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;105;111;115;115;121;122;122;123;128;129;139;140;140;145;145;145;145;145;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;146;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;147;152;155;175;201\t1\t1\t0.00053692\tBy MS/MS\tBy matching\t58.8\t58.8\t16340000\t13939000\t2401100\t8170000\t6969400\t1200500\t0\t4426400\t1\t0\t1\t\t\t+\t2\t4769\tTrue\t4840\t10105;10106\t14759\t14759\t\t",
                    line);
            line = reader.readLine();
            assertEquals(
                    "FAF\tgi|63100331;gi|30583211;gi|27769301;gi|229463044;CON__Q61782;gi|17512236\tgi|63100331;gi|30583211;gi|27769301;gi|229463044;gi|17512236;gi|15431310;gi|12803709;gi|119581151;CON__P02533;gi|386848;gi|119581150\t16;16;16;16;16;16;16;16;16;14;13;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;4;3;3;2;2;1\t11;11;11;11;11;11;11;11;11;9;8;5;5;2;2;2;2;2;2;2;2;2;2;2;2;2;2;3;3;2;2;2;1\t5;5;5;5;5;5;5;5;5;4;4;2;2;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;0;1;0;1\t>gi|63100331|gb|AAH94830.1| Keratin 14 [Homo sapiens];>gi|30583211|gb|AAP35850.1| keratin 14 (epidermolysis bullosa simplex, Dowling-Meara, Koebner) [Homo sapiens];>gi|27769301|gb|AAH42437.1| Keratin 14 [Homo sapiens];>gi|229463044|sp|P02533.4|K1C14_HUMAN \t33\t16\t11\t5\t15\t11\t10\t7\t5\t2\t38.8\t33.5\t18\t51.651\t472\t472;472;472;472;472;472;472;472;472;472;393;261;261;431;432;432;432;432;432;432;432;432;432;432;433;433;434;452;131;349;157;266;93\t10\t7\t3.8259E-73\tBy MS/MS\tBy MS/MS\t36.9\t25.4\t378670000\t251170000\t127490000\t12622000\t8372500\t4249700\t271170000\t215030000\t16\t7\t23\t\t\t+\t3\t392;565;652;960;1891;2802;3586;3750;4151;4237;4239;4649;6147;8115;8436;8437\tTrue;True;True;True;True;True;True;True;False;False;False;True;True;True;False;False\t400;576;663;977;1926;2845;3638;3805;4210;4297;4299;4718;6260;8257;8581;8582;8583\t842;843;1229;1230;1422;1423;2070;4043;4044;5940;7647;7983;7984;8816;8817;8989;8990;8993;8994;9850;9851;13012;17245;17924;17925;17926;17927;17928\t1216;1217;1218;1219;1910;1911;1912;1913;2233;3181;6016;6017;6018;6019;8850;11435;11436;11899;11900;12981;12982;12983;12984;12985;12986;13224;13225;13226;13227;13229;13230;13231;13232;13233;13234;14438;14439;18788;24843;25923;25924;25925;25926;25927;25928;25929;25930\t1217;1911;2233;3181;6017;8850;11436;11900;12982;13227;13234;14438;18788;24843;25926;25930\t2\t119",
                    line);
        }
        temp.delete();
    }

    private ProteinMapping getProteinMapping(Integer gi, String geneName) {
        ProteinMapping mapping = new ProteinMapping();
        mapping.setGi(gi);
        mapping.setGeneName(geneName);
        return mapping;
    }
}
